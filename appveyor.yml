# configuration for develop/CI branch

-
  branches:
    only:
      - dev
      - master

  skip_tags: true
  image: Visual Studio 2017
  configuration: Release
  platform: Any CPU

  pull_requests:
    do_not_increment_build_number: false

  install:
    - choco install gitversion.portable -pre -y

  before_build:
    - ps: cd src
    - ps: .paket\paket restore
    - ps: cd..
    - ps: gitversion /l console /output buildserver /updateAssemblyInfo

  build:
    verbosity: minimal

  after_build:
    - ps: $env:SIGNTOOL="C:\Program Files (x86)\Windows Kits\10\bin\x64\signtool.exe"
    - ps: $env:SIGNTOOL sign /v /n "Jan Karger" /sm /s MY /tr "http://timestamp.digicert.com" /td SHA256 /fd SHA256 ".\src\bin\Release\SimpleMusicPlayer.exe"

  cache:
    - src\packages -> **\packages.config
    # - '%USERPROFILE%\.nuget\packages -> **\project.json'

  artifacts:
    - path: \src\bin\Release\
      name: SimpleMusicPlayer.$(GitVersion_AssemblySemVer)
      type: zip
