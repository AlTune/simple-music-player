<UserControl x:Class="SimpleMusicPlayer.Views.PlayControlView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ViewModels="clr-namespace:SimpleMusicPlayer.ViewModels"
             xmlns:ValueConverters="clr-namespace:SimpleMusicPlayer.ValueConverters"
             mc:Ignorable="d"
             d:DesignHeight="300"
             d:DesignWidth="300"
             d:DataContext="{d:DesignInstance ViewModels:PlayControlViewModel}">

  <UserControl.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colours.xaml" />
        <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
        <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
        <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.AnimatedSingleRowTabControl.xaml" />
        <ResourceDictionary Source="pack://application:,,,/SimpleMusicPlayer;component/Resources/Icons.xaml" />
        <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Blue.xaml" />
        <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseDark.xaml" />
      </ResourceDictionary.MergedDictionaries>

      <ValueConverters:SliderPositionValueToTextConverter x:Key="SliderPositionValueToTextConverter" />
      <ValueConverters:SliderRemainingPositionValueToTextConverter x:Key="SliderRemainingPositionValueToTextConverter" />
    </ResourceDictionary>
  </UserControl.Resources>

  <Grid>

    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <Grid Grid.Row="0"
          HorizontalAlignment="Stretch">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="100" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="100" />
      </Grid.ColumnDefinitions>

      <!-- volume -->
      <Slider Grid.Column="0"
              Margin="10,2,10,2"
              Orientation="Horizontal"
              Minimum="0"
              Maximum="1"
              Value="{Binding PlayerEngine.Volume}" />

      <!-- prev -->
      <Button Grid.Column="1"
              VerticalAlignment="Center"
              Style="{DynamicResource MetroCircleButtonStyle}"
              Height="45"
              Width="45">
        <Rectangle Width="16"
                   Height="16">
          <Rectangle.Fill>
            <VisualBrush Stretch="Fill"
                         Visual="{StaticResource appbar_fastforward}" />
          </Rectangle.Fill>
          <Rectangle.LayoutTransform>
            <ScaleTransform ScaleX="-1" />
          </Rectangle.LayoutTransform>
        </Rectangle>
      </Button>

      <!-- play -->
      <Button Grid.Column="2"
              Command="{Binding PlayCommand, Mode=OneWay}"
              VerticalAlignment="Center"
              Style="{DynamicResource MetroCircleButtonStyle}"
              Height="55"
              Width="55">
        <Rectangle Width="16"
                   Margin="3,0,0,0"
                   Height="16">
          <Rectangle.Fill>
            <VisualBrush Stretch="Fill"
                         Visual="{StaticResource appbar_play}" />
          </Rectangle.Fill>
        </Rectangle>
      </Button>

      <!-- next -->
      <Button Grid.Column="3"
              VerticalAlignment="Center"
              Style="{DynamicResource MetroCircleButtonStyle}"
              Height="45"
              Width="45">
        <Rectangle Width="16"
                   Height="16">
          <Rectangle.Fill>
            <VisualBrush Stretch="Fill"
                         Visual="{StaticResource appbar_fastforward}" />
          </Rectangle.Fill>
        </Rectangle>
      </Button>
    </Grid>

    <Grid Grid.Row="1"
          HorizontalAlignment="Center">

      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>

      <!-- position -->
      <TextBlock Grid.Column="0"
                 HorizontalAlignment="Right"
                 VerticalAlignment="Center"
                 Text="{Binding ElementName=positionSlider, Path=Value, Mode=OneWay, FallbackValue='0:00', Converter={StaticResource SliderPositionValueToTextConverter}}" />
      <Slider Grid.Column="1"
              x:Name="positionSlider"
              VerticalAlignment="Center"
              Width="250"
              Margin="10,2,10,2"
              Orientation="Horizontal"
              Minimum="0"
              Thumb.DragStarted="PositionSlider_DragStarted"
              Thumb.DragCompleted="PositionSlider_DragCompleted"
              Maximum="{Binding PlayerEngine.Length.TotalMilliseconds, Mode=OneWay}"
              Value="{Binding PlayerEngine.CurrentPositionMs, Mode=TwoWay, UpdateSourceTrigger=Explicit}" />
      <TextBlock Grid.Column="2"
                 HorizontalAlignment="Left"
                 VerticalAlignment="Center">
        <TextBlock.Text>
          <MultiBinding FallbackValue="-0:00"
                        Converter="{StaticResource SliderRemainingPositionValueToTextConverter}">
            <Binding ElementName="positionSlider"
                     Path="Value"
                     Mode="OneWay" />
            <Binding ElementName="positionSlider"
                     Path="Maximum"
                     Mode="OneWay" />
          </MultiBinding>
        </TextBlock.Text>
      </TextBlock>

    </Grid>

  </Grid>
</UserControl>
